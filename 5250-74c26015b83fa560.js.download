!function(){try{var r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=Error().stack;e&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[e]="dd6c2110-51b2-4a0f-990a-21f03d0691b1",r._sentryDebugIdIdentifier="sentry-dbid-dd6c2110-51b2-4a0f-990a-21f03d0691b1")}catch(r){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"b071f675"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5250],{45250:function(r,e,n){n.d(e,{Z:function(){return g},l:function(){return h}});var t=n(27387),o=n(63257),u=n(96583),i=n(96082),s=n(58997),l=n(73878),a=n(72106),c=n(17437),f=n(95636),d=n(45228),p=n(92756),h=".replit";function g(r){var e,n,g,E,N=r.container,R=r.fs,C=r.ctx,v=(0,i.ZP)();v.setMaxListeners(50);var _=null,y=null,w=null;function b(){return O.apply(this,arguments)}function O(){return(O=(0,t._)(function(){return(0,u.Jh)(this,function(r){return _&&"open"===_.status?[2,_]:[2,new Promise(function(r){v.once(s.zW.CHANNEL_OPENED,function(e){r(e)})})]})})).apply(this,arguments)}(function(){M.apply(this,arguments)})(),N.openChannel({service:"dotreplit"},function(r){var e=r.channel;return _=e,v.emit(s.zW.CHANNEL_OPENED,e),function(){_=null}});var D=!1;function M(){return(M=(0,t._)(function(){return(0,u.Jh)(this,function(r){return R.watchDir(a.Ql,{onChange:function(r){if(!r.some(function(r){return r.filename===h&&r.type===l.Tv.File})){(null==y?void 0:y.error)!==s.Yt.NotFound&&(y={error:s.Yt.NotFound,errorMessage:"",config:null},v.emit(s.zW.CHANGE,y));return}D||(D=!0,R.watchFile(h,{onChange:function(){y=null,k.getConfig({bypassCache:!0}).then(function(r){v.emit(s.zW.CHANGE,r)})},onMoveOrDelete:function(){D=!1},onError:function(r,e){y=null,D=!1,r.code||N.unrecoverableError(r,e)}}))},onError:function(r,e){N.unrecoverableError(r,e)}}),[2]})})).apply(this,arguments)}function A(){return(A=(0,t._)(function(){return(0,u.Jh)(this,function(r){switch(r.label){case 0:return y=null,w||(w=function(){return L.apply(this,arguments)}()),[4,w];case 1:return y=r.sent(),w=null,[2,y]}})})).apply(this,arguments)}function L(){return(L=(0,t._)(function(){return(0,u.Jh)(this,function(r){var e;return[2,(0,f.DW)(C,"dotreplit.getConfigFromServer",(e=(0,t._)(function(r,e){var n,t,o,i;return(0,u.Jh)(this,function(u){switch(u.label){case 0:var l,a,c;return null==e||e.setAttributes((l={},(null==(a=N.getConnectionMetadata())?void 0:a.token)&&(l.tokenCluster=(0,d.h)(a.token).cluster),c=!!window.performance.getEntriesByName(p.Iy.pageNavStart,"mark").length,l.ssr=c,l)),[4,b()];case 1:if("closed"===(t=u.sent()).status)return[2,{error:s.Yt.Disconnected,errorMessage:"channel closed",config:null}];return[4,t.request({dotReplitGetRequest:{},traceInfo:r?(0,f.Rg)(r):void 0})];case 2:if((o=u.sent()).channelClosed)return[2,{error:s.Yt.Disconnected,errorMessage:"channel closed",config:null}];if(o.error){if(o.error.includes("unable to decode"))return[2,{error:s.Yt.ParseError,errorMessage:o.error,config:null}];if(o.error.includes("no such file"))return[2,{error:s.Yt.NotFound,errorMessage:o.error,config:null}];return[2,{error:s.Yt.Unknown,errorMessage:o.error,config:null}]}if(!(i=null===(n=o.dotReplitGetResponse)||void 0===n?void 0:n.dotReplit))return N.unrecoverableError(Error("Dotreplit responded with no error and no config")),[2,{error:s.Yt.Unknown,errorMessage:"Expected dotReplitGetResponse to include dotReplit",config:null}];return[2,{error:null,errorMessage:null,config:i}]}})}),function(r,n){return e.apply(this,arguments)}))]})})).apply(this,arguments)}var P=(e=(0,t._)(function(r){var e;return(0,u.Jh)(this,function(n){switch(n.label){case 0:return[4,R.stat(h)];case 1:if(n.sent().exists)return[3,3];return[4,R.writeFile(h,"")];case 2:n.sent(),n.label=3;case 3:return[4,b()];case 4:return[4,n.sent().request({dotReplitUpdateRequest:{ops:r}})];case 5:if((e=n.sent()).channelClosed)return[2,{errorMessage:"Channel closed.",error:s.au.ChannelClosed,response:null}];if(e.error){if(e.error.includes("could not parse json")||e.error.includes("is not json")||e.error.includes("parsing value field")||e.error.includes("missing field"))return[2,{errorMessage:e.error,error:s.au.JSONParseError,response:null}];if(e.error.includes("could not read file"))return[2,{errorMessage:e.error,error:s.au.NotFound,response:null}];if(e.error.includes("could not parse toml"))return[2,{errorMessage:e.error,error:s.au.TOMLParseError,response:null}];if(e.error.includes("unknown variant"))return[2,{errorMessage:e.error,error:s.au.OpType,response:null}];if(e.error.includes("could not write to file"))return[2,{errorMessage:e.error,error:s.au.CouldNotWrite,response:null}];if(e.error.includes("could not read line"))return[2,{errorMessage:e.error,error:s.au.ReadLine,response:null}];return[2,{errorMessage:e.error,error:s.au.Unknown,response:null}]}if(!e.dotReplitUpdateResponse)throw Error("Expected .replit to be updated");return[2,{response:e.dotReplitUpdateResponse,error:null,errorMessage:null}]}})}),function(r){return e.apply(this,arguments)}),k={watch:function(r){var e=!1,n=!1,t=function(){for(var e=arguments.length,t=Array(e),u=0;u<e;u++)t[u]=arguments[u];n=!0,r.apply(void 0,(0,o._)(t))};return v.on(s.zW.CHANGE,t),k.getConfig().then(function(r){e||n||t(r)}),function(){e=!0,v.removeListener(s.zW.CHANGE,t)}},getConfig:function(r){return(0,t._)(function(){return(0,u.Jh)(this,function(e){return(null==r?void 0:r.bypassCache)||!y?[2,function(){return A.apply(this,arguments)}()]:[2,y]})})()},getRunConfig:function(){return(0,t._)(function(){var r,e;return(0,u.Jh)(this,function(n){switch(n.label){case 0:return[4,b()];case 1:return[4,n.sent().request({runConfigGetRequest:{}})];case 2:if((r=n.sent()).channelClosed)return[2,this.getRunConfig()];if(!r.runConfigGetResponse)throw null!==(e=r.error)&&void 0!==e?e:Error("expected run config");return[2,r.runConfigGetResponse]}})}).apply(this)},updateDotReplit:(n=[],g=400,E=(0,c.Z)((0,t._)(function(){var r;return(0,u.Jh)(this,function(e){switch(e.label){case 0:return[4,P(n)];case 1:return r=e.sent(),n=[],[2,r]}})}),{wait:g}),function(r,e){e&&(g=e);var t=!0,o=!1,u=void 0;try{for(var i,s=r[Symbol.iterator]();!(t=(i=s.next()).done);t=!0)!function(){var r=i.value,e=n.findIndex(function(e){return e.path===r.path});-1!==e?n[e]=r:n.push(r)}()}catch(r){o=!0,u=r}finally{try{t||null==s.return||s.return()}finally{if(o)throw u}}return E()})};return k}},58997:function(r,e,n){var t,o,u,i,s,l;n.d(e,{Yt:function(){return t},au:function(){return o},zW:function(){return u}}),(i=t||(t={})).NotFound="NOT_FOUND",i.ParseError="PARSE_ERROR",i.Disconnected="DISCONNECTED",i.Unknown="UNKOWN_ERROR",(s=o||(o={})).ChannelClosed="CHANNEL_CLOSED",s.JSONParseError="JSON_PARSE_ERROR",s.NotFound="NOT_FOUND",s.TOMLParseError="TOML_PARSE_ERROR",s.OpType="OP_TYPE",s.CouldNotWrite="COULD_NOT_WRITE",s.ReadLine="COULD_NOT_READ_LINE",s.Unknown="UNKNOWN_ERROR",(l=u||(u={})).CHANGE="CHANGE",l.CHANNEL_OPENED="CHANNEL_OPENED"}}]);
//# sourceMappingURL=5250-74c26015b83fa560.js.map